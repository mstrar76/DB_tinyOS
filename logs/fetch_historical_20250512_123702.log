{"timestamp": "2025-05-12T12:37:02.964062", "level": "INFO", "message": "Script started. Logs will be saved to logs/fetch_historical_20250512_123702.log", "module": "fetch_historical_orders_debug", "service": "fetch_historical_orders", "correlation_id": "645bc495-437d-4e19-99ba-1a52334990eb"}
{"timestamp": "2025-05-12T12:37:02.965133", "level": "INFO", "message": "Database environment variables", "module": "fetch_historical_orders_debug", "service": "fetch_historical_orders", "correlation_id": "6968a3eb-be1c-48ce-8120-11552e3bc59c", "context": {"DB_HOST_exists": true, "DB_NAME_exists": true, "DB_USER_exists": true, "DB_PASSWORD_exists": true, "DB_PORT_exists": true}}
{"timestamp": "2025-05-12T12:37:04.243449", "level": "INFO", "message": "Successfully connected to database", "module": "fetch_historical_orders_debug", "service": "fetch_historical_orders", "correlation_id": "dca3cf1e-5908-4fed-bd20-5af7d9cbb414"}
{"timestamp": "2025-05-12T12:37:04.245042", "level": "INFO", "message": "Token file contents", "module": "fetch_historical_orders_debug", "service": "fetch_historical_orders", "correlation_id": "f24e69ea-b78c-4c8e-8f55-853d027acc69", "context": {"keys_present": ["access_token", "refresh_token", "expires_at", "last_renewal"], "token_exists": true, "refresh_token_exists": true, "expires_at": 1747066688.667721, "last_renewal": 1747052288.667725}}
{"timestamp": "2025-05-12T12:37:04.245126", "level": "INFO", "message": "Successfully loaded access token", "module": "fetch_historical_orders_debug", "service": "fetch_historical_orders", "correlation_id": "3ae38b8f-47b3-458a-ac94-55974ec439d9"}
{"timestamp": "2025-05-12T12:37:04.245192", "level": "INFO", "message": "Testing API connection", "module": "fetch_historical_orders_debug", "service": "fetch_historical_orders", "correlation_id": "d9ee2844-21a7-4bbd-bdbb-da4a9b473e23"}
{"timestamp": "2025-05-12T12:37:04.245263", "level": "INFO", "message": "Requesting orders list", "module": "fetch_historical_orders_debug", "service": "fetch_historical_orders", "correlation_id": "d4db2651-7ff2-4e66-a54d-786252deb159", "context": {"start_date": "2023-01-01", "end_date": "2023-01-02", "page": 1, "url": "https://api.tiny.com.br/public-api/v3/ordem-servico", "params": {"situacao": "3", "dataInicialEmissao": "2023-01-01", "dataFinalEmissao": "2023-01-02", "limit": 100, "offset": 0}}}
{"timestamp": "2025-05-12T12:37:04.850674", "level": "INFO", "message": "API response received", "module": "fetch_historical_orders_debug", "service": "fetch_historical_orders", "correlation_id": "f1999fee-1638-48d2-9693-679b003ccde4", "context": {"status_code": 200, "content_type": "application/json", "response_length": 2818}}
{"timestamp": "2025-05-12T12:37:04.851966", "level": "ERROR", "message": "API response missing 'data' field", "module": "fetch_historical_orders_debug", "service": "fetch_historical_orders", "correlation_id": "00b23819-d7e7-4792-bf4d-3471112ac617", "context": {"response_keys": ["itens", "paginacao"], "response_snippet": "{'itens': [{'id': 568836266, 'situacao': '3', 'data': '2023-01-02', 'dataPrevista': '', 'valor': 0, 'numeroOrdemServico': '27713', 'cliente': {'nome': 'Abner  vicen\u00e7oto', 'codigo': '', 'fantasia': '', 'tipoPessoa': 'F', 'cpfCnpj': '487.410.468-11', 'inscricaoEstadual': '', 'rg': '', 'telefone': '', 'celular': '(14) 99608-5167', 'email': 'Abnervicencoto123@gmail.com', 'endereco': {'endereco': 'Rua Jos\u00e9 Gobbo', 'numero': '839', 'complemento': '', 'bairro': 'Centro', 'municipio': 'Tagua\u00ed', 'cep': '"}}
{"timestamp": "2025-05-12T12:37:04.855944", "level": "ERROR", "message": "API connection test failed. Cannot proceed.", "module": "fetch_historical_orders_debug", "service": "fetch_historical_orders", "correlation_id": "93ac7e0f-8494-4382-8100-5b71b309efdc"}
